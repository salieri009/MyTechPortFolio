# Key Vault Integration Template
# Retrieves secrets from Azure Key Vault for pipeline use

parameters:
  - name: keyVaultName
    type: string
  - name: secrets
    type: object
    default: []

steps:
  - task: AzureKeyVault@2
    displayName: 'Retrieve Secrets from Key Vault'
    inputs:
      azureSubscription: 'Azure_Subscription_Connection'
      KeyVaultName: ${{ parameters.keyVaultName }}
      SecretsFilter: ${{ join(parameters.secrets, ';') }}
      RunAsPreJob: true

  # Set secrets as pipeline variables (masked)
  - script: |
      echo "Secrets retrieved from Key Vault:"
      # Secrets are automatically available as environment variables
      # They are masked in logs for security
    displayName: 'Verify Key Vault Secrets'
    condition: always()

